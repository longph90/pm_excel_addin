!function(){function e(){var e=document.getElementById("accountSelect").value,n=document.getElementById("fullnameDisplay");e?Excel.run((function(a){var o=a.workbook.worksheets.getItem("Resource").tables.getItem("TblResource").getRange();return o.load("values"),a.sync().then((function(){for(var a=o.values,c=a[0],r=1;r<a.length;r++)if(a[r][c.indexOf("Account")]===e)return n.innerText=a[r][c.indexOf("Fullname")],void t();n.innerText=""}))})).catch((function(e){console.log("Error: "+e)})):n.innerText=""}function t(){var e=document.getElementById("accountSelect").value;e?Excel.run((function(t){var a=t.workbook.worksheets.getItem("WBS").tables.getItem("TblWbs").getRange();return a.load("values"),t.sync().then((function(){var t=a.values,o={"Tổng nhiệm vụ":[],"Task đang làm":[],"Task chưa làm":[],"Task chờ review":[],"Task chờ release":[],"Task đã release":[]};t.forEach((function(t){var n,a,c=t[3].trim().toLowerCase(),r=t[12];n='PIC: "'.concat(c.trim().toLowerCase(),'", Selected Account: "').concat(e.trim().toLowerCase(),'"'),(a=document.getElementById("notification")).textContent=n,a.className="alert alert-".concat("sussced"," position-fixed bottom-0 start-50 translate-middle-x mb-3"),a.classList.remove("d-none"),setTimeout((function(){a.classList.add("d-none")}),3e3),c===e.trim().toLowerCase()&&(o["Tổng nhiệm vụ"].push(t),r>0&&r<80?o["Task đang làm"].push(t):0===r?o["Task chưa làm"].push(t):80===r?o["Task chờ review"].push(t):90===r?o["Task chờ release"].push(t):100===r&&o["Task đã release"].push(t))})),document.getElementById("totalTasksCount").innerText=o["Tổng nhiệm vụ"].length,document.getElementById("doingCount").innerText=o["Task đang làm"].length,document.getElementById("notDoneCount").innerText=o["Task chưa làm"].length,document.getElementById("reviewCount").innerText=o["Task chờ review"].length,document.getElementById("releaseCount").innerText=o["Task chờ release"].length,document.getElementById("releasedCount").innerText=o["Task đã release"].length,document.getElementById("doingTasks").innerHTML=n(o["Task đang làm"]),document.getElementById("notDoneTasks").innerHTML=n(o["Task chưa làm"]),document.getElementById("reviewTasks").innerHTML=n(o["Task chờ review"]),document.getElementById("releaseTasks").innerHTML=n(o["Task chờ release"]),document.getElementById("releasedTasks").innerHTML=n(o["Task đã release"])}))})).catch((function(e){console.error("Error retrieving tasks:",e),document.getElementById("response-content").innerText="Error retrieving tasks."})):document.getElementById("response-content").innerText="Please select an account."}function n(e){if(0===e.length)return"<p>No tasks available.</p>";var t="<table class='table table-bordered'>";return t+="<thead><tr>",t+="<th>TaskID</th><th>P.StartDate</th><th>P.EndDate</th><th>P.Effort</th>",t+="<th>A.StartDate</th><th>A.EndDate</th><th>A.Effort</th><th>%A.Completed</th>",t+="</tr></thead><tbody>",e.forEach((function(e){t+="<tr>",t+='<td><a href="#">'.concat(e[0],"</a></td>"),t+="<td>".concat(a(e[5]),"</td>"),t+="<td>".concat(a(e[6]),"</td>"),t+="<td>".concat(e[8],"</td>"),t+="<td>".concat(a(e[9]),"</td>"),t+="<td>".concat(a(e[10]),"</td>"),t+="<td>".concat(e[11],"</td>"),t+="<td>".concat(e[12],"</td>"),t+="</tr>"})),t+="</tbody></table>"}function a(e){return!e||isNaN(e)?"":new Date(86400*(e-25569)*1e3).toISOString().split("T")[0]}Office.onReady((function(t){t.host===Office.HostType.Excel&&(Excel.run((function(e){var t=e.workbook.worksheets.getItem("Resource").tables.getItem("TblResource").getRange();return t.load("values"),e.sync().then((function(){for(var e=t.values,n=document.getElementById("accountSelect"),a=e[0],o=1;o<e.length;o++){var c=e[o][a.indexOf("Account")],r=document.createElement("option");r.value=c,r.text=c,n.appendChild(r)}}))})).catch((function(e){console.log("Error: "+e)})),document.getElementById("accountSelect").onchange=e)}))}();
//# sourceMappingURL=taskbymember.js.map