"use strict";(self.webpackChunkoffice_addin_taskpane_js=self.webpackChunkoffice_addin_taskpane_js||[]).push([[271],{28271:function(e,t,a){a.r(t);var n=a(96540),r=a(20735),c=a(54354);t.default=()=>{const[e,t]=(0,n.useState)((new Date).getFullYear()),[a,s]=(0,n.useState)((new Date).getMonth()+1),[o,u]=(0,n.useState)(E(e,a)),[l,i]=(0,n.useState)([]),[m,p]=(0,n.useState)([]);(0,n.useEffect)((()=>{(async()=>{const e=await(0,r.jF)("Resource","TblResource"),t=(await(0,r.VD)(e)).map((e=>e.Account));i(t);const a=await(0,r.jF)("Timesheet","TblTimeSheet"),n=await(0,r.VD)(a);p(n)})()}),[]);const f=l&&l.length>0?l.map((t=>{const n={Account:t};return o.forEach((c=>{const[s]=c.split("("),o=`${e}-${a.toString().padStart(2,"0")}-${s}`,u=m.filter((e=>e.Account===t&&(0,r._f)(e.Date)===o)).reduce(((e,t)=>e+t.TotalTime),0).toFixed(1);n[`Effort_${c}`]=`${u}/8`})),n})):[],g=[{header:"Account/Date",key:"Account"},...o.map((e=>({header:e,key:`Effort_${e}`})))],d=o.reduce(((e,t)=>(e[`Effort_${t}`]={red:e=>{const[t,a]=e.split("/").map(Number),n=t/a;return n<.8||n>1.2},green:e=>{const[t,a]=e.split("/").map(Number),n=t/a;return n>=.8&&n<=1.2},textWhite:()=>!0},e)),{});function E(e,t){const a=new Date(e,t-1,1),n=[],r=["S","M","T","W","T","F","S"];for(;a.getMonth()===t-1;){const e=a.getDay();if(0!==e&&6!==e){const t=a.getDate().toString().padStart(2,"0"),c=r[e];n.push(`${t}(${c})`)}a.setDate(a.getDate()+1)}return n}return n.createElement("div",null,n.createElement("h1",null,"Project Work Log"),n.createElement("div",{id:"output"}),n.createElement("div",null,n.createElement("div",{className:"input-group input-group-sm mb-3"},n.createElement("span",{className:"input-group-text"},"Year"),n.createElement("select",{className:"form-select",value:e,onChange:e=>{const n=parseInt(e.target.value,10);t(n),u(E(n,a))}},[2022,2023,2024,2025].map((e=>n.createElement("option",{key:e,value:e},e))))),n.createElement("div",{className:"input-group input-group-sm mb-3"},n.createElement("span",{className:"input-group-text"},"Month"),n.createElement("select",{className:"form-select",value:a,onChange:t=>{const a=parseInt(t.target.value,10);s(a),u(E(e,a))}},[1,2,3,4,5,6,7,8,9,10,11,12].map((e=>n.createElement("option",{key:e,value:e},e.toString().padStart(2,"0"))))))),n.createElement(c.A,{data:f,columns:g,colorConfig:d}))}}}]);
//# sourceMappingURL=271.js.map