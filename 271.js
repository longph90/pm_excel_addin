"use strict";(self.webpackChunkoffice_addin_taskpane_js=self.webpackChunkoffice_addin_taskpane_js||[]).push([[271],{28271:function(e,t,a){a.r(t);var n=a(96540),c=a(20735),r=a(54354);t.default=()=>{const[e,t]=(0,n.useState)((new Date).getFullYear()),[a,o]=(0,n.useState)((new Date).getMonth()+1),[s,u]=(0,n.useState)(E(e,a)),[l,i]=(0,n.useState)([]),[m,p]=(0,n.useState)([]);(0,n.useEffect)((()=>{(async()=>{const e=await(0,c.jF)("Resource","TblResource"),t=(await(0,c.VD)(e)).map((e=>({Account:e.Account,Planned:e.Planned})));i(t);const a=await(0,c.jF)("Timesheet","TblTimeSheet"),n=await(0,c.VD)(a);p(n)})()}),[]);const f=l&&l.length>0?l.map((t=>{const n={Account:t.Account};return s.forEach((r=>{const[o]=r.split("("),s=`${e}-${a.toString().padStart(2,"0")}-${o}`,u=m.filter((e=>e.Account===t.Account&&(0,c._f)(e.Date)===s)).reduce(((e,t)=>e+t.TotalTime),0).toFixed(1);n[`Effort_${r}`]=`${u}/${t.Planned}`})),n})):[],d=[{header:"Account/Date",key:"Account"},...s.map((e=>({header:e,key:`Effort_${e}`})))],g=s.reduce(((e,t)=>(e[`Effort_${t}`]={red:e=>{const[t,a]=e.split("/").map(Number),n=t/a;return n<.8||n>1.2},green:e=>{const[t,a]=e.split("/").map(Number),n=t/a;return n>=.8&&n<=1.2},textWhite:()=>!0},e)),{});function E(e,t){const a=new Date(e,t-1,1),n=[],c=["S","M","T","W","T","F","S"];for(;a.getMonth()===t-1;){const e=a.getDay();if(0!==e&&6!==e){const t=a.getDate().toString().padStart(2,"0"),r=c[e];n.push(`${t}(${r})`)}a.setDate(a.getDate()+1)}return n}return n.createElement("div",null,n.createElement("h1",null,"Project Work Log"),n.createElement("div",{id:"output"}),n.createElement("div",null,n.createElement("div",{className:"input-group input-group-sm mb-3"},n.createElement("span",{className:"input-group-text"},"Year"),n.createElement("select",{className:"form-select",value:e,onChange:e=>{const n=parseInt(e.target.value,10);t(n),u(E(n,a))}},[2022,2023,2024,2025].map((e=>n.createElement("option",{key:e,value:e},e))))),n.createElement("div",{className:"input-group input-group-sm mb-3"},n.createElement("span",{className:"input-group-text"},"Month"),n.createElement("select",{className:"form-select",value:a,onChange:t=>{const a=parseInt(t.target.value,10);o(a),u(E(e,a))}},[1,2,3,4,5,6,7,8,9,10,11,12].map((e=>n.createElement("option",{key:e,value:e},e.toString().padStart(2,"0"))))))),n.createElement(r.A,{data:f,columns:d,colorConfig:g}))}}}]);
//# sourceMappingURL=271.js.map