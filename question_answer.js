!function(){"use strict";var e={85910:function(e,t,n){function a(e,t){const n=document.getElementById("notification");n.textContent=e,n.className=`alert alert-${t}`,n.style.display="block",setTimeout((()=>{n.style.display="none"}),1e4)}async function s(e,t){try{return await Excel.run((async n=>{const a=n.workbook.worksheets.getItem(e).tables.getItem(t).getRange();return a.load("values"),await n.sync(),a.values}))}catch(t){throw a("Error when reading data from "+e+": "+t.message,"danger"),t}}function r(e,t,n,s){return new Promise(((r,o)=>{Excel.run((a=>{let d=a.workbook.worksheets.getItem(e).tables.getItem(t),u=d.getRange();return u.load("values"),a.sync().then((()=>{let e=u.values[0],t={};e.forEach(((e,n)=>{t[e]=n}));for(let e in s)if(Object.prototype.hasOwnProperty.call(s,e)){let a=t[e];if(void 0===a)return void o(`Column name "${e}" not found`);u.values[n][a]=s[e]}return d.getDataBodyRange().getRow(n).values=[u.values[n]],a.sync().then((()=>{r("Data updated successfully")}))}))})).catch((t=>{a("Error when updating data in "+e+": "+t.message,"danger"),o(t)}))}))}function o(e,t,n){return new Promise(((s,r)=>{Excel.run((a=>{let o=a.workbook.worksheets.getItem(e).tables.getItem(t),d=o.getRange();return d.load("values"),a.sync().then((()=>{let e=d.values[0],t=new Array(e.length).fill("");for(let a in n)if(Object.prototype.hasOwnProperty.call(n,a)){let s=e.indexOf(a);if(-1===s)return void r(`Column name "${a}" not found`);t[s]=n[a]}return o.rows.add(null,[t]),a.sync().then((()=>{s("Data inserted successfully")}))}))})).catch((t=>{a("Error when inserting data in "+e+": "+t.message,"danger"),r(t)}))}))}n.d(t,{Wy:function(){return r},Yh:function(){return o},jF:function(){return s}}),Object.freeze({OPEN:"OPEN",IN_PROGRESS:"IN_PROGRESS",WAITING_REVIEW:"WAITING_REVIEW",WAITING_RELEASE:"WAITING_RELEASE",RELEASED:"RELEASED"})}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var a=n(85910),s=new bootstrap.Modal(document.getElementById("qaModal"));function r(e){return["ID","TaskID","Status","Question_VN","Question_Date","Raised_Person","Answer_VN","Answer_Date","Answer_Person","Question_JP","Answer_JP"].indexOf(e)}function o(e){e.preventDefault();const t=this.getAttribute("data-rowIndex"),n=this.getAttribute("data-qaid"),a=this.getAttribute("data-taskid"),r=this.getAttribute("data-status"),o=this.getAttribute("data-questiondate"),d=this.getAttribute("data-raisedperson"),u=this.getAttribute("data-questionVN"),i=this.getAttribute("data-questionJP"),l=this.getAttribute("data-answerJP"),c=this.getAttribute("data-answerVN");this.getAttribute("data-answerDate"),this.getAttribute("data-answerPerson"),document.getElementById("f_rowIndex").value=t-1,document.getElementById("f_qaid").value=n,document.getElementById("f_taskId").value=a,document.getElementById("f_status").value=r,document.getElementById("f_questionDate").value=o,document.getElementById("f_raisedPerson").value=d,document.getElementById("f_questionVN").value=u,document.getElementById("f_questionJP").value=i,document.getElementById("f_answerJP").value=l,document.getElementById("f_answerVN").value=c,document.getElementById("updateBtn").style.display="inline",document.getElementById("createBtn").style.display="none",s.show()}function d(e){return!e||isNaN(e)?"":new Date(86400*(e-25569)*1e3).toISOString().split("T")[0]}function u(){const e=l(),t={ID:e.qaid,TaskID:e.taskId,Status:e.status,Question_VN:e.questionVN,Question_Date:e.questionDate,Raised_Person:e.raisedPerson,Answer_VN:e.answerVN,Answer_Date:e.answerVN,Answer_Person:e.Answer_Person,Question_JP:e.questionJP,Answer_JP:e.answerJP};(0,a.Yh)("Q&A","TblQA",t),s.hide()}function i(){const e=l(),t=Number(e.rowIndex),n={ID:e.qaid,TaskID:e.taskId,Status:e.status,Question_VN:e.questionVN,Question_Date:e.questionDate,Raised_Person:e.raisedPerson,Answer_VN:e.answerVN,Answer_Date:e.answerVN,Answer_Person:e.Answer_Person,Question_JP:e.questionJP,Answer_JP:e.answerJP};(0,a.Wy)("Q&A","TblQA",t,n),s.hide()}function l(){return{rowIndex:document.getElementById("f_rowIndex").value,qaid:document.getElementById("f_qaid").value,taskId:document.getElementById("f_taskId").value,status:document.getElementById("f_status").value,questionDate:document.getElementById("f_questionDate").value,raisedPerson:document.getElementById("f_raisedPerson").value,questionVN:document.getElementById("f_questionVN").value,questionJP:document.getElementById("f_questionJP").value,answerJP:document.getElementById("f_answerJP").value,answerVN:document.getElementById("f_answerVN").value}}Office.onReady((e=>{e.host===Office.HostType.Excel&&(document.getElementById("addNewBtn").addEventListener("click",(function(){document.getElementById("qaForm").reset(),document.getElementById("f_qaid").readOnly=!1,document.getElementById("updateBtn").style.display="none",document.getElementById("createBtn").style.display="inline",s.show()})),document.getElementById("createBtn").addEventListener("click",u),document.getElementById("updateBtn").addEventListener("click",i),(async()=>{try{!function(e){let t=0;const n=e.map(((e,t)=>({index:t,id:e[r("ID")],taskId:e[r("TaskID")],status:e[r("Status")],questionVN:e[r("Question_VN")],questionDate:e[r("Question_Date")],raisedPerson:e[r("Raised_Person")],answerVN:e[r("Answer_VN")],answerDate:e[r("Answer_Date")],answerPerson:e[r("Answer_Person")],questionJP:e[r("Question_JP")],answerJP:e[r("Answer_JP")]}))),a={Open:[],WaitingClientFeedback:[],WaitingConfirm:[],Confirmed:[],Closed:[]};n.forEach((e=>{a[e.status]?(t+=1,a[e.status].push(e)):console.warn(`Unknown status: ${e.status}`)})),Object.keys(a).forEach((e=>{const t=a[e],n=document.getElementById(`${e.replace(/ /g,"")}Tasks`),s=document.getElementById(`${e.replace(/ /g,"")}Count`);t.length>0?n.innerHTML=`\n    <table class='table table-bordered'>\n        <tr>\n            <th>ID</th>\n            <th>TaskID</th>\n            <th>Status</th>\n            <th>Question Date</th>\n            <th>Raised Person</th>\n        </tr>\n        ${t.map((e=>`\n            <tr>\n                <td>\n                    <a href="#" class="openModal link-info" \n                       data-rowIndex="${e.index}" \n                       data-qaid="${e.id}" \n                       data-taskid="${e.taskId}" \n                       data-status="${e.status}" \n                       data-questionVN="${e.questionVN}" \n                       data-questiondate="${d(e.questionDate)}" \n                       data-raisedperson="${e.raisedPerson}" \n                       data-answerVN="${e.answerVN}" \n                       data-answerDate="${e.answerDate}" \n                       data-answerPerson="${e.answerPerson}" \n                       data-questionJP="${e.questionJP}" \n                       data-answerJP="${e.answerJP}">\n                        ${e.id}\n                    </a>\n                </td>\n                <td>${e.taskId}</td>\n                <td>${e.status}</td>\n                <td>${d(e.questionDate)}</td>\n                <td>${e.raisedPerson}</td>\n            </tr>\n        `)).join("")}\n    </table>\n`:n.innerHTML="No Q&A available.",s.textContent=t.length})),document.getElementById("totalCount").textContent=t,document.querySelectorAll(".openModal").forEach((e=>{e.addEventListener("click",o)}))}(await(0,a.jF)("Q&A","TblQA"))}catch(e){console.error("Error:",e)}})())}))}();
//# sourceMappingURL=question_answer.js.map