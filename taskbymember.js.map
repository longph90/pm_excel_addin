{"version":3,"file":"taskbymember.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/taskbymember/common.js","webpack://office-addin-taskpane-js/./src/taskbymember/constant.js","webpack://office-addin-taskpane-js/./src/taskbymember/taskbymember.js"],"sourcesContent":["/**\n * Converts a JavaScript Date string to an Excel date number.\n * @param {string} dateString - The date string in 'YYYY-MM-DD' format.\n * @returns {number} The Excel date number.\n */\nexport function jsDateToExcelDate(dateString) {\n  // Convert the date string to a JavaScript Date object\n  const date = new Date(dateString);\n  // Convert JavaScript Date to Excel date number\n  let excelDate = 25569.0 + (date.getTime() - date.getTimezoneOffset() * 60 * 1000) / (1000 * 60 * 60 * 24);\n  return excelDate;\n}\n\n/**\n * Converts an Excel date number to a JavaScript Date object.\n * @param {number} excelDate - The Excel date number.\n * @returns {string} The date in 'YYYY-MM-DD' format, or an empty string if input is invalid.\n */\nexport function excelDateToJSDate(excelDate) {\n  // Check if the input is valid\n  if (!excelDate || isNaN(excelDate)) {\n    return \"\";\n  }\n  // Convert Excel date to JavaScript Date\n  const utcDate = new Date((excelDate - 25569) * 86400 * 1000);\n  // Return the date in 'YYYY-MM-DD' format\n  return utcDate.toISOString().split(\"T\")[0];\n}\n\n/**\n * Displays a notification message to the user.\n * @param {string} message - The message to display.\n * @param {string} type - The type of notification (e.g., 'success', 'error', 'warning').\n */\nexport function showNotification(message, type) {\n  // Get the notification element\n  const notificationEl = document.getElementById(\"notification\");\n\n  // Set the message content\n  notificationEl.textContent = message;\n\n  // Set the CSS classes for styling and positioning\n  notificationEl.className = `alert alert-${type}`;\n\n  // Make the notification visible\n  notificationEl.style.display = \"block\";\n\n  // Hide the notification after 5 seconds\n  setTimeout(() => {\n    notificationEl.style.display = \"none\";\n  }, 5000);\n}\n\nexport function getDataTable(sheetName, tableName) {\n  return new Promise((resolve, reject) => {\n    Excel.run((context) => {\n      // Get the specified sheet\n      let sheet = context.workbook.worksheets.getItem(sheetName);\n      // Get the specified table\n      let table = sheet.tables.getItem(tableName);\n      // Load the header row\n      let range = table.getRange();\n      range.load(\"values\");\n\n      return context.sync().then(() => {\n        resolve(range.values);\n      });\n    }).catch((error) => {\n      showNotification(\"Error when reading data from \" + sheetName + \": \" + error.message, \"danger\");\n      reject(error);\n    });\n  });\n}\n\nexport async function getDataHeader(sheetName, tableName) {\n  try {\n    const data = await getDataTable(sheetName, tableName);\n    return data[0];\n  } catch (error) {\n    showNotification(\"Error when reading data from\" + sheetName + \": \" + error.message, \"danger\");\n  }\n}\n\nexport async function getIndexByColumnName(sheetName, tableName, columnName) {\n  try {\n    const data = await getDataTable(sheetName, tableName);\n    return data[0].indexOf(columnName);\n  } catch (error) {\n    return -1;\n  }\n}\n\nexport function getIndexRowbyTaskId(data, taskId) {\n  try {\n    const taskIndex = data.findIndex((row) => row[0] === taskId); // Tìm index của task\n    return taskIndex;\n  } catch (error) {\n    return -1;\n  }\n}\n","export const STATUS = Object.freeze({\n  OPEN: \"OPEN\",\n  IN_PROGRESS: \"IN_PROGRESS\",\n  WAITING_REVIEW: \"WAITING_REVIEW\",\n  WAITING_RELEASE: \"WAITING_RELEASE\",\n  RELEASED: \"RELEASED\",\n});\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n// You can specify which plugins you need\nimport {\n  excelDateToJSDate,\n  jsDateToExcelDate,\n  showNotification,\n  getIndexByColumnName,\n  getDataTable,\n  getIndexRowbyTaskId,\n} from \"./common.js\";\nimport { STATUS } from \"./constant.js\";\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    // initData();\n\n    loadAccounts();\n    getTasksByAccount();\n    document.getElementById(\"accountSelect\").onchange = loadFullname;\n\n    // Add click event listener to the \"Update Progress\" button\n    document.getElementById(\"btnUpdateProgress\").addEventListener(\"click\", function () {\n      // Get the task ID from the input field\n      const taskId = document.getElementById(\"progressTaskID\").value;\n\n      // Create an object with updated task data from form inputs\n      const taskData = {\n        // get plan value\n        pic: document.getElementById(\"pic\").value,\n        reviewer: document.getElementById(\"reviewer\").value,\n        pStartDate: document.getElementById(\"pStartDate\").value,\n        pEndDate: document.getElementById(\"pEndDate\").value,\n        pEffort: document.getElementById(\"pEffort\").value,\n\n        // get actual value\n        startDate: document.getElementById(\"aStartDate\").value,\n        endDate: document.getElementById(\"aEndDate\").value,\n        effort: document.getElementById(\"aEffort\").value,\n        percentCompleted: document.getElementById(\"percentACompleted\").value,\n        releaseDate: document.getElementById(\"aReleaseDate\").value,\n\n        // get link value\n        linkJR: document.getElementById(\"linkJira\").value,\n        linkBD: document.getElementById(\"linkBD\").value,\n        linkDD: document.getElementById(\"linkDD\").value,\n        linkET: document.getElementById(\"linkEstimatedTask\").value,\n        linkED: document.getElementById(\"linkEvidence\").value,\n        linkFR: document.getElementById(\"linkFileReview\").value,\n      };\n\n      // Fetch the task by ID (possibly to validate or prepare for update)\n      getTaskByID(taskId);\n\n      // Update the task details with the new data\n      updateTaskDetails(taskId, taskData);\n      loadFullname();\n\n      // Close the modal after update\n      let myModalElement = document.getElementById(\"updateProgressModal\");\n\n      // Try to get an instance of the Bootstrap modal\n      // eslint-disable-next-line no-undef\n      let myModal = bootstrap.Modal.getInstance(myModalElement);\n\n      if (myModal) {\n        // If an instance exists, hide the modal\n        myModal.hide();\n      } else {\n        // If no instance exists, create a new one and hide it\n        // eslint-disable-next-line no-undef\n        let newModal = new bootstrap.Modal(myModalElement);\n        newModal.hide();\n      }\n    });\n\n    let myModalElement = document.getElementById(\"updateProgressModal\");\n    myModalElement.addEventListener(\"hidden.bs.modal\", function () {\n      // Các hành động cần thiết sau khi modal đã đóng\n      console.log(\"Modal đã đóng.\");\n    });\n\n    // Wait for the DOM to be fully loaded before executing the script\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      // Set the default date for the logwork form to today's date\n      setDefaultLogworkDate();\n    });\n  }\n});\n\n/**\n * Sets the default date for the logwork form to today's date.\n */\nfunction setDefaultLogworkDate() {\n  // Get today's date in YYYY-MM-DD format\n  const today = getTodayDate();\n\n  // Set the value of the date input field\n  const dateInput = document.getElementById(\"logworkForm_date\");\n  if (dateInput) {\n    dateInput.value = today;\n  } else {\n    console.warn(\"Logwork date input field not found\");\n  }\n}\n\n/**\n * Returns today's date in YYYY-MM-DD format.\n * @returns {string} Today's date in YYYY-MM-DD format\n */\nfunction getTodayDate() {\n  return new Date().toISOString().split(\"T\")[0];\n}\n\nfunction updateTaskDetails(taskID, taskData) {\n  Excel.run(function (context) {\n    const sheet = context.workbook.worksheets.getItem(\"WBS\");\n    const table = sheet.tables.getItem(\"TblWbs\");\n    const range = table.getDataBodyRange();\n    range.load(\"values\");\n\n    return context.sync().then(function () {\n      const data = range.values;\n      const taskIndex = data.findIndex((row) => row[0] === taskID); // Tìm index của task\n\n      if (taskIndex !== -1) {\n        // Tạo một mảng mới với các giá trị cập nhật\n        const updatedRow = [...data[taskIndex]];\n\n        // Update value for plan section\n        updatedRow[3] = taskData.pic;\n        updatedRow[4] = taskData.reviewer;\n        updatedRow[5] = jsDateToExcelDate(taskData.pStartDate);\n        updatedRow[6] = jsDateToExcelDate(taskData.pEndDate);\n        updatedRow[8] = taskData.pEffort;\n\n        // Update value for actual section\n        updatedRow[9] = jsDateToExcelDate(taskData.startDate);\n        updatedRow[10] = jsDateToExcelDate(taskData.endDate);\n        updatedRow[11] = taskData.effort;\n        updatedRow[12] = taskData.percentCompleted / 100;\n        updatedRow[13] = jsDateToExcelDate(taskData.releaseDate);\n\n        // Cập nhật toàn bộ hàng\n        range.getRow(taskIndex).values = [updatedRow];\n\n        // Update value for link\n        const cellIndices = [16, 17, 18, 19, 20, 21];\n        const hyperlinks = [\n          { textToDisplay: \"Link\", screenTip: \"Link Jira\", address: taskData.linkJR },\n          { textToDisplay: \"Link\", screenTip: \"Link BD\", address: taskData.linkBD },\n          { textToDisplay: \"Link\", screenTip: \"Link DD\", address: taskData.linkDD },\n          { textToDisplay: \"Link\", screenTip: \"Link Estimation Task\", address: taskData.linkET },\n          { textToDisplay: \"Link\", screenTip: \"Link Evidence\", address: taskData.linkED },\n          { textToDisplay: \"Link\", screenTip: \"Link File Review\", address: taskData.linkFR },\n        ];\n\n        cellIndices.forEach((index, i) => {\n          let cellRange = range.getCell(taskIndex, index);\n          let hyperlink = hyperlinks[i];\n          if (hyperlink.address) {\n            // Kiểm tra nếu taskData có giá trị\n            cellRange.set({\n              hyperlink: hyperlink,\n            });\n          } else {\n            cellRange.values = [[\"\"]];\n          }\n        });\n\n        return context.sync().then(function () {\n          showNotification(\"Update Successfully\", \"success\");\n        });\n      } else {\n        showNotification(\"Không tìm thấy thông tin: \" + taskID, \"danger\");\n      }\n    });\n  }).catch(function (error) {\n    console.log(error);\n    showNotification(\"Error updating task details: \" + error.message, \"danger\");\n  });\n}\n\nfunction getTaskByID(taskId) {\n  Excel.run(function (context) {\n    const sheet = context.workbook.worksheets.getItem(\"WBS\");\n    const table = sheet.tables.getItem(\"TblWbs\");\n    const range = table.getDataBodyRange();\n    range.load([\"values\"]);\n\n    const sheetSetting = context.workbook.worksheets.getItem(\"Setting\");\n    const domain = sheetSetting.getRange(\"B3\");\n    domain.load(\"values\");\n\n    return context.sync().then(function () {\n      const values = range.values;\n\n      const task = values.find((row) => row[0] === taskId); // Tìm task dựa trên TaskID\n      const taskIndex = values.findIndex((row) => row[0] === taskId); // Lấy index của task\n      if (task) {\n        document.querySelector(\"#progressForm #progressTaskID\").value = taskId;\n\n        const linkToBack = document.querySelector(\"#linkToBack\");\n        const backlogUrl = domain.values[0][0];\n        linkToBack.href = `${backlogUrl}${taskId}`;\n        linkToBack.textContent = `Open Backlog`;\n        linkToBack.target = \"_blank\";\n        linkToBack.rel = \"noopener noreferrer\";\n\n        // For Plan Section\n        document.querySelector(\"#progressForm #pic\").value = task[3]; // PIC\n        document.querySelector(\"#progressForm #reviewer\").value = task[4]; // Reviewer\n        document.querySelector(\"#progressForm #pStartDate\").value = excelDateToJSDate(task[5]); // P.StartDate\n        document.querySelector(\"#progressForm #pEndDate\").value = excelDateToJSDate(task[6]); // P.EndDate\n        document.querySelector(\"#progressForm #pEffort\").value = task[8]; // P.Effort\n\n        // For Actual Section\n        document.querySelector(\"#progressForm #aStartDate\").value = excelDateToJSDate(task[9]); // A.StartDate\n        document.querySelector(\"#progressForm #aEndDate\").value = excelDateToJSDate(task[10]); // A.EndDate\n        document.querySelector(\"#progressForm #aEffort\").value = task[11]; // A.Effort\n        document.querySelector(\"#progressForm #percentACompleted\").value = task[12] * 100; // %A.Completed\n        document.querySelector(\"#progressForm #aReleaseDate\").value = excelDateToJSDate(task[13]); // A.ReleaseDate\n\n        // Lấy hyperlink từ giá trị hoặc từ đối tượng hyperlink nếu có\n        // Link Jira\n        const cellIndices = [16, 17, 18, 19, 20, 21];\n        const formFields = [\"linkJira\", \"linkBD\", \"linkDD\", \"linkEstimatedTask\", \"linkEvidence\", \"linkFileReview\"];\n\n        const cellRanges = cellIndices.map((index) => {\n          let cellRange = range.getCell(taskIndex, index);\n          cellRange.load(\"hyperlink\");\n          return cellRange;\n        });\n\n        return context.sync().then(function () {\n          cellRanges.forEach((cellRange, i) => {\n            let hyperlink = cellRange.hyperlink;\n            let value = hyperlink ? hyperlink.address : task[cellIndices[i]];\n            document.querySelector(`#progressForm #${formFields[i]}`).value = value;\n          });\n        });\n      } else {\n        showNotification(\"không tìm thấy thông tin: \" + taskId, \"danger\");\n      }\n    });\n  }).catch(function (error) {\n    console.log(error);\n  });\n}\n\nfunction initData() {\n  Excel.run(function (context) {\n    var sheet = context.workbook.worksheets.getItem(\"Setting\");\n    var range = sheet.getRange(\"B1:B5\");\n\n    range.load(\"values\");\n    return context.sync().then(function () {\n      var project_code = range.values[0];\n      var project_manager = range.values[1];\n      document.getElementById(\"v_project_code\").innerText = project_code;\n      document.getElementById(\"v_project_manager\").innerText = project_manager;\n    });\n  }).catch(function (error) {\n    console.log(\"Error: \" + error);\n  });\n}\n\nfunction loadAccounts() {\n  Excel.run(function (context) {\n    let sheet = context.workbook.worksheets.getItem(\"Resource\");\n    let table = sheet.tables.getItem(\"TblResource\");\n    let range = table.getRange();\n\n    range.load(\"values\");\n\n    return context.sync().then(function () {\n      let data = range.values; // Lấy toàn bộ giá trị trong bảng\n      let accountSelect = document.getElementById(\"accountSelect\");\n      let headers = data[0];\n      let accountIndex = headers.indexOf(\"Account\");\n      // Lặp qua dữ liệu để thêm vào combobox\n      for (let i = 1; i < data.length; i++) {\n        // Bỏ qua hàng tiêu đề\n        let account = data[i][accountIndex]; // Column Account (index 1)\n        let option = document.createElement(\"option\");\n        option.value = account;\n        option.text = account;\n        accountSelect.appendChild(option);\n      }\n    });\n  }).catch(function (error) {\n    console.log(\"Error: \" + error);\n  });\n}\n\nfunction loadFullname() {\n  let accountSelect = document.getElementById(\"accountSelect\");\n  let selectedAccount = accountSelect.value;\n  let fullnameDisplay = document.getElementById(\"fullnameDisplay\");\n\n  if (selectedAccount) {\n    Excel.run(function (context) {\n      let sheet = context.workbook.worksheets.getItem(\"Resource\");\n      let table = sheet.tables.getItem(\"TblResource\");\n      let range = table.getRange();\n\n      range.load(\"values\");\n\n      return context.sync().then(function () {\n        let data = range.values;\n        let headers = data[0];\n\n        // Tìm fullname tương ứng với account đã chọn\n        for (let i = 1; i < data.length; i++) {\n          // Bỏ qua hàng tiêu đề\n          if (data[i][headers.indexOf(\"Account\")] === selectedAccount) {\n            // Column Account (index 1)\n            fullnameDisplay.innerText = data[i][headers.indexOf(\"Fullname\")]; // Column Fullname (index 2)\n            getTasksByAccount();\n            return;\n          }\n        }\n        fullnameDisplay.innerText = \"\"; // Nếu không tìm thấy, xóa nội dung\n      });\n    }).catch(function (error) {\n      console.log(\"Error: \" + error);\n    });\n  } else {\n    fullnameDisplay.innerText = \"\"; // Nếu không chọn gì, xóa nội dung\n    getTasksByAccount();\n  }\n}\n\nfunction getTasksByAccount() {\n  const selectedAccount = document.getElementById(\"accountSelect\").value.trim().toLowerCase();\n\n  Excel.run(function (context) {\n    const sheet = context.workbook.worksheets.getItem(\"WBS\");\n    const table = sheet.tables.getItem(\"TblWbs\");\n    const range = table.getRange();\n    range.load(\"values\");\n\n    return context.sync().then(function () {\n      const data = range.values;\n\n      // Update lại toàn bộ giá trị tại cell 16, 17, 18, 19 là giá trị hyperlink\n      const cellIndices = [16, 17, 18, 19, 20, 21];\n      const cellRanges = data\n        .map((row, rowIndex) => {\n          return cellIndices.map((index) => {\n            let cellRange = range.getCell(rowIndex, index);\n            cellRange.load([\"hyperlink\", \"rowIndex\", \"columnIndex\"]);\n            return cellRange;\n          });\n        })\n        .flat();\n\n      return context.sync().then(function () {\n        cellRanges.forEach((cellRange) => {\n          let hyperlink = cellRange.hyperlink;\n          if (hyperlink) {\n            let rowIndex = cellRange.rowIndex;\n            let colIndex = cellRange.columnIndex;\n            data[rowIndex][colIndex] = hyperlink.address;\n          }\n        });\n\n        const groupedTasks = processTaskData(data, selectedAccount);\n        updateUIWithTaskData(groupedTasks);\n      });\n    });\n  }).catch(function (error) {\n    console.error(\"Error retrieving tasks:\", error);\n    showNotification(\"Error retrieving tasks:\" + error, \"danger\");\n  });\n}\n\nfunction processTaskData(data, selectedAccount) {\n  const groupedTasks = {\n    \"Tổng nhiệm vụ\": [],\n    \"Task doing\": [],\n    \"Task notDone\": [],\n    \"Task review\": [],\n    \"Task release\": [],\n    \"Task released\": [],\n  };\n\n  data.forEach((row) => {\n    const pic = row[3].trim().toLowerCase();\n    const reviewer = row[4].trim().toLowerCase();\n    const completed = row[12];\n\n    if (shouldIncludeTask(pic, reviewer, selectedAccount)) {\n      categorizeTask(row, completed, groupedTasks);\n    }\n  });\n\n  return groupedTasks;\n}\n\nfunction shouldIncludeTask(pic, reviewer, selectedAccount) {\n  return selectedAccount === \"\" || pic === selectedAccount || reviewer === selectedAccount;\n}\n\nfunction categorizeTask(row, completed, groupedTasks) {\n  groupedTasks[\"Tổng nhiệm vụ\"].push(row);\n\n  if (completed > 0 && completed < 0.8) {\n    groupedTasks[\"Task doing\"].push(row);\n  } else if (completed === 0) {\n    groupedTasks[\"Task notDone\"].push(row);\n  } else if (completed === 0.8) {\n    groupedTasks[\"Task review\"].push(row);\n  } else if (completed === 0.9) {\n    groupedTasks[\"Task release\"].push(row);\n  } else if (completed === 1) {\n    groupedTasks[\"Task released\"].push(row);\n  }\n}\n\nfunction updateUIWithTaskData(groupedTasks) {\n  const counts = {\n    total: groupedTasks[\"Tổng nhiệm vụ\"].length,\n    doing: groupedTasks[\"Task doing\"].length,\n    notDone: groupedTasks[\"Task notDone\"].length,\n    review: groupedTasks[\"Task review\"].length,\n    release: groupedTasks[\"Task release\"].length,\n    released: groupedTasks[\"Task released\"].length,\n  };\n\n  updateTaskCounts(counts);\n  updateProgressBar(counts);\n  updateTaskTables(groupedTasks);\n  addEventListeners();\n}\n\nfunction updateTaskCounts(counts) {\n  Object.entries(counts).forEach(([key, value]) => {\n    const element = document.getElementById(`${key}Count`);\n    if (element) {\n      element.innerText = value;\n    } else {\n      console.warn(`Element with id \"${key}Count\" not found`);\n    }\n  });\n}\n\nfunction updateProgressBar(counts) {\n  document.getElementById(\"taskProgressBar\").innerHTML = addProgressBar(\n    counts.total,\n    counts.notDone,\n    counts.doing,\n    counts.review,\n    counts.release,\n    counts.released\n  );\n}\n\nfunction updateTaskTables(groupedTasks) {\n  const taskStatuses = {\n    notDoneTasks: STATUS.OPEN,\n    doingTasks: STATUS.IN_PROGRESS,\n    reviewTasks: STATUS.WAITING_REVIEW,\n    releaseTasks: STATUS.WAITING_RELEASE,\n    releasedTasks: null,\n  };\n\n  Object.entries(taskStatuses).forEach(([elementId, status]) => {\n    const taskGroup = elementId.replace(\"Tasks\", \"\");\n    document.getElementById(elementId).innerHTML = createTaskTable(groupedTasks[`Task ${taskGroup}`], status);\n  });\n}\n\nfunction addEventListeners() {\n  addModalEventListeners();\n  [STATUS.OPEN, STATUS.IN_PROGRESS, STATUS.WAITING_REVIEW, STATUS.WAITING_RELEASE].forEach(addBtnTaskStartListeners);\n}\n\nfunction addProgressBar(total, notStarted, inProgress, waitForReview, waitForRelease, released) {\n  let progressBarHTML = `\n      <div class='progress-bar progress-bar-striped bg-danger'\n           role='progressbar'\n           style='width: ${(notStarted / total) * 100}%'\n           aria-valuenow='${(notStarted / total) * 100}'\n           aria-valuemin='0'\n           aria-valuemax='100'>\n          ${((notStarted / total) * 100).toFixed(2)}%\n      </div>\n`;\n\n  progressBarHTML += `\n      <div class='progress-bar progress-bar-striped bg-warning'\n           role='progressbar'\n           style='width: ${(inProgress / total) * 100}%'\n           aria-valuenow='${(inProgress / total) * 100}'\n           aria-valuemin='0'\n           aria-valuemax='100'>\n          ${((inProgress / total) * 100).toFixed(2)}%\n      </div>\n`;\n\n  progressBarHTML += `\n<div class='progress-bar progress-bar-striped bg-warning'\n     role='progressbar'\n     style='width: ${(waitForReview / total) * 100}%'\n     aria-valuenow='${(waitForReview / total) * 100}'\n     aria-valuemin='0'\n     aria-valuemax='100'>\n    ${((waitForReview / total) * 100).toFixed(2)}%\n</div>\n`;\n\n  progressBarHTML += `\n<div class='progress-bar progress-bar-striped bg-warning'\n     role='progressbar'\n     style='width: ${(waitForRelease / total) * 100}%'\n     aria-valuenow='${(waitForRelease / total) * 100}'\n     aria-valuemin='0'\n     aria-valuemax='100'>\n    ${((waitForRelease / total) * 100).toFixed(2)}%\n</div>\n`;\n\n  progressBarHTML += `\n<div class='progress-bar progress-bar-striped bg-success'\n     role='progressbar'\n     style='width: ${(released / total) * 100}%'\n     aria-valuenow='${(released / total) * 100}'\n     aria-valuemin='0'\n     aria-valuemax='100'>\n    ${((released / total) * 100).toFixed(2)}%\n</div>\n`;\n\n  return progressBarHTML;\n}\n\n// Hàm để tạo bảng từ dữ liệu tác vụ\nfunction createTaskTable(tasks, status) {\n  if (tasks.length === 0) {\n    return \"<p>No tasks available.</p>\";\n  }\n\n  const headers = getTableHeaders(status);\n  const rows = tasks.map((task) => createTableRow(task, status));\n\n  return `\n    <table class='table table-bordered'>\n      <thead>\n        <tr>${headers.join(\"\")}</tr>\n      </thead>\n      <tbody>\n        ${rows.join(\"\")}\n      </tbody>\n    </table>\n  `;\n}\n\nfunction getTableHeaders(status) {\n  const baseHeaders = [\"TaskID\", \"TaskName\", \"P.StartDate\", \"P.EndDate\", \"P.Effort\", \"PIC\", \"Reviewer\"];\n\n  if (status !== STATUS.OPEN) {\n    // baseHeaders.push(\"A.StartDate\", \"A.EndDate\", \"A.Effort\", \"%A.Completed\");\n    baseHeaders.push(\"A.Effort\", \"%A.Completed\");\n  }\n\n  if ([STATUS.OPEN, STATUS.IN_PROGRESS, STATUS.WAITING_REVIEW, STATUS.WAITING_RELEASE].includes(status)) {\n    baseHeaders.push(\"Action\");\n  }\n\n  baseHeaders.push(\"Link Refer\");\n  return baseHeaders.map((header) => `<th>${header}</th>`);\n}\n\nfunction createTableRow(task, status) {\n  const cells = [\n    `<td><a href=\"#\" class=\"openModal link-info\" data-taskid=\"${task[0]}\">${task[0]}</a></td>`,\n    `<td><span class=\"d-inline-block text-truncate\" style=\"max-width: 50px;\">${task[1]}</span></td>`,\n    `<td>${excelDateToJSDate(task[5])}</td>`,\n    `<td>${excelDateToJSDate(task[6])}</td>`,\n    `<td>${task[8]}</td>`,\n    `<td>${task[3]}</td>`,\n    `<td>${task[4]}</td>`,\n  ];\n\n  if (status !== STATUS.OPEN) {\n    cells.push(\n      // `<td>${excelDateToJSDate(task[9])}</td>`,\n      // `<td>${excelDateToJSDate(task[10])}</td>`,\n      `<td>${task[11]}</td>`,\n      `<td>${task[12] * 100}%</td>`\n    );\n  }\n\n  cells.push(getActionButton(task, status));\n\n  const link = {\n    linkBD: task[17],\n    linkDD: task[18],\n    linkET: task[19],\n    linkEV: task[20],\n  };\n  cells.push(createDropdown(link));\n\n  return `<tr>${cells.join(\"\")}</tr>`;\n}\nfunction createDropdown(link) {\n  let dropdownItems = \"\"; // Chuỗi lưu trữ các mục trong dropdown\n\n  // Kiểm tra và thêm thẻ <li> nếu link tồn tại\n  if (link.linkBD) {\n    dropdownItems += `<li><a class=\"dropdown-item\" href=\"${link.linkBD}\" target=\"_blank\" rel=\"noopener noreferrer\">Link BD</a></li>`;\n  }\n  if (link.linkDD) {\n    dropdownItems += `<li><a class=\"dropdown-item\" href=\"${link.linkDD}\" target=\"_blank\" rel=\"noopener noreferrer\">Link DD</a></li>`;\n  }\n  if (link.linkET) {\n    dropdownItems += `<li><a class=\"dropdown-item\" href=\"${link.linkET}\" target=\"_blank\" rel=\"noopener noreferrer\">Link Estimation</a></li>`;\n  }\n  if (link.linkEV) {\n    dropdownItems += `<li><a class=\"dropdown-item\" href=\"${link.linkEV}\" target=\"_blank\" rel=\"noopener noreferrer\">Link Evidence</a></li>`;\n  }\n\n  // Nếu không có link nào tồn tại, thêm một mục \"No Links\"\n  if (!dropdownItems) {\n    dropdownItems = `<li><a class=\"dropdown-item\" href=\"#\">No Links Available</a></li>`;\n  }\n\n  // Trả về HTML hoàn chỉnh của dropdown\n  return `\n    <td>\n      <div class=\"dropdown\">\n        <button class=\"btn btn-sm btn-secondary dropdown-toggle\" type=\"button\" id=\"dropdownMenuButton1\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n          Link\n        </button>\n        <ul class=\"dropdown-menu\" aria-labelledby=\"dropdownMenuButton1\">\n          ${dropdownItems}\n        </ul>\n      </div>\n    </td>\n  `;\n}\n\nfunction getActionButton(task, status) {\n  const buttons = {\n    [STATUS.OPEN]: {\n      class: \"btn-task-start\",\n      icon: \"▶️\",\n      tooltip: \"Click To Start Task\",\n      validateLink: task[18],\n    },\n    [STATUS.IN_PROGRESS]: {\n      class: \"btn-task-inprogress\",\n      icon: \"✅\",\n      tooltip: \"Mark as Completed\",\n      validateLink: task[17],\n    },\n    [STATUS.WAITING_REVIEW]: {\n      class: \"btn-task-review\",\n      icon: \"✅\",\n      tooltip: \"Mark as Pass Review\",\n    },\n    [STATUS.WAITING_RELEASE]: {\n      class: \"btn-task-release\",\n      icon: \"🚀\",\n      tooltip: \"Click To Release Task\",\n    },\n  };\n\n  const button = buttons[status];\n  if (!button) return \"\";\n\n  return `\n    <td>\n      <button \n        class=\"btn btn-sm ${button.class}\" \n        data-taskid=\"${task[0]}\" \n        data-validateLink=\"${button.validateLink}\"\n        title=\"${button.tooltip}\"\n        data-toggle=\"tooltip\" \n        data-placement=\"top\"\n      >\n        ${button.icon}\n      </button>\n    </td>\n  `;\n}\n\nfunction addBtnTaskStartListeners(status) {\n  const listenerConfig = {\n    [STATUS.OPEN]: {\n      elementId: \"notDoneTasks\",\n      buttonClass: \"btn-task-start\",\n      completionPercentage: 0.1,\n      updateField: { index: 9, value: \"A.StartDate\" },\n      validateLink: { flg: true, message: \"Add link estimation vào, giỡn mặt hả???\" },\n    },\n    [STATUS.IN_PROGRESS]: {\n      elementId: \"doingTasks\",\n      buttonClass: \"btn-task-inprogress\",\n      completionPercentage: 0.8,\n      validateLink: { flg: true, message: \"Add link evidence vào, giỡn mặt hả???\" },\n    },\n    [STATUS.WAITING_REVIEW]: {\n      elementId: \"reviewTasks\",\n      buttonClass: \"btn-task-review\",\n      completionPercentage: 0.9,\n      updateField: { index: 10, value: \"A.EndDate\" },\n    },\n    [STATUS.WAITING_RELEASE]: {\n      elementId: \"releaseTasks\",\n      buttonClass: \"btn-task-release\",\n      completionPercentage: 1,\n      updateField: { index: 13, value: \"A.ReleaseDate\" },\n    },\n  };\n\n  const config = listenerConfig[status];\n  if (!config) return;\n\n  document.getElementById(config.elementId).addEventListener(\"click\", handleTaskUpdate);\n\n  function handleTaskUpdate(e) {\n    if (e.target && e.target.classList.contains(config.buttonClass)) {\n      if (config.validateLink) {\n        const validLink = e.target.getAttribute(\"data-validateLink\");\n        if (!validateLink(validLink, config.validateLink.message)) return;\n      }\n      const taskId = e.target.getAttribute(\"data-taskid\");\n      updateTaskInExcel(taskId, config)\n        .then(() => {\n          loadFullname();\n          showNotification(\"Task updated successfully!\", \"success\");\n        })\n        .catch((error) => {\n          console.log(error);\n          showNotification(`Error: ${error.message}`, \"danger\");\n        });\n    }\n  }\n  function validateLink(input, message) {\n    if (!input) {\n      showNotification(`${message}`, \"danger\");\n      return false;\n    }\n    return true;\n  }\n\n  function updateTaskInExcel(taskId, config) {\n    return Excel.run((context) => {\n      const wbsTable = context.workbook.tables.getItem(\"TblWbs\");\n      const wbsRange = wbsTable.getDataBodyRange();\n      wbsRange.load(\"values\");\n\n      return context.sync().then(() => {\n        const wbsData = wbsRange.values;\n        const taskIndex = wbsData.findIndex((row) => row[0] === taskId);\n\n        if (taskIndex !== -1) {\n          const updatedRow = [...wbsData[taskIndex]];\n          updatedRow[12] = config.completionPercentage; // %A.Completed\n\n          if (config.updateField) {\n            const today = new Date().toISOString().split(\"T\")[0]; // Format: YYYY-MM-DD\n            updatedRow[config.updateField.index] = jsDateToExcelDate(today);\n          }\n\n          wbsRange.getRow(taskIndex).values = [updatedRow];\n        }\n\n        return context.sync();\n      });\n    });\n  }\n}\n\nfunction addModalEventListeners() {\n  const openModalLinks = document.querySelectorAll(\".openModal\");\n  const updateProgressModal = document.getElementById(\"updateProgressModal\");\n  const progressTaskIDInput = document.getElementById(\"progressTaskID\");\n\n  openModalLinks.forEach((link) => {\n    link.addEventListener(\"click\", handleModalOpen);\n  });\n\n  function handleModalOpen(event) {\n    event.preventDefault();\n    const taskId = this.getAttribute(\"data-taskid\");\n    progressTaskIDInput.value = taskId;\n    getTaskByID(taskId);\n    showModal();\n  }\n\n  function showModal() {\n    // eslint-disable-next-line no-undef\n    const myModal = new bootstrap.Modal(updateProgressModal);\n    myModal.show();\n  }\n}\n"],"names":["jsDateToExcelDate","dateString","date","Date","getTime","getTimezoneOffset","excelDateToJSDate","excelDate","isNaN","toISOString","split","showNotification","message","type","notificationEl","document","getElementById","textContent","className","concat","style","display","setTimeout","STATUS","Object","freeze","OPEN","IN_PROGRESS","WAITING_REVIEW","WAITING_RELEASE","RELEASED","getTaskByID","taskId","Excel","run","context","range","workbook","worksheets","getItem","tables","getDataBodyRange","load","domain","getRange","sync","then","values","task","find","row","taskIndex","findIndex","querySelector","value","linkToBack","backlogUrl","href","target","rel","cellIndices","formFields","cellRanges","map","index","cellRange","getCell","forEach","i","hyperlink","address","catch","error","console","log","loadFullname","selectedAccount","fullnameDisplay","data","headers","length","indexOf","innerText","getTasksByAccount","trim","toLowerCase","rowIndex","flat","colIndex","columnIndex","groupedTasks","pic","reviewer","completed","shouldIncludeTask","push","categorizeTask","processTaskData","counts","total","doing","notDone","review","release","released","entries","_ref","_ref2","_slicedToArray","key","element","warn","updateTaskCounts","notStarted","inProgress","waitForReview","waitForRelease","progressBarHTML","innerHTML","toFixed","updateProgressBar","taskStatuses","notDoneTasks","doingTasks","reviewTasks","releaseTasks","releasedTasks","_ref3","_ref4","elementId","status","taskGroup","replace","tasks","baseHeaders","includes","header","getTableHeaders","rows","cells","button","_defineProperty","class","icon","tooltip","validateLink","getActionButton","link","linkBD","linkDD","linkET","linkEV","dropdownItems","createDropdown","join","createTableRow","createTaskTable","updateTaskTables","openModalLinks","querySelectorAll","updateProgressModal","progressTaskIDInput","handleModalOpen","event","preventDefault","this","getAttribute","bootstrap","Modal","show","addEventListener","addModalEventListeners","addBtnTaskStartListeners","updateUIWithTaskData","config","buttonClass","completionPercentage","updateField","flg","e","classList","contains","input","wbsRange","wbsData","updatedRow","_toConsumableArray","today","getRow","updateTaskInExcel","Office","onReady","info","host","HostType","accountSelect","accountIndex","account","option","createElement","text","appendChild","onchange","taskData","pStartDate","pEndDate","pEffort","startDate","endDate","effort","percentCompleted","releaseDate","linkJR","linkED","linkFR","taskID","hyperlinks","textToDisplay","screenTip","set","updateTaskDetails","myModalElement","myModal","getInstance","hide","dateInput"],"sourceRoot":""}