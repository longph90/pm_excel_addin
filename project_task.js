!function(){function e(){const e=document.getElementById("taskForm");e.checkValidity()?Excel.run((function(e){const o=e.workbook.worksheets.getItem("WBS").tables.getItem("TblWbs"),n=document.getElementById("taskID").value,r=document.getElementById("taskName").value,u=document.getElementById("type").value,c=document.getElementById("pic").value,l=document.getElementById("reviewer").value,a=document.getElementById("pStartDate").value,d=document.getElementById("pEndDate").value,m=document.getElementById("pReleaseDate").value,s=document.getElementById("pEffort").value,i=document.getElementById("aStartDate").value,y=document.getElementById("aEndDate").value,g=document.getElementById("aEffort").value,v=document.getElementById("percentACompleted").value,f=document.getElementById("aReleaseDate").value,p=document.getElementById("parentID").value,E=document.getElementById("linkBackLog").value,S=document.getElementById("linkJira").value,F=document.getElementById("linkEvidence").value;return o.rows.add(null,[[n,r,u,c,l,a,d,m,s,i,y,g,v,f,p,E,S,F]]),e.sync().then((()=>{t("Task added successfully!","success")}))})).catch((function(e){console.log(e),t(`Error: ${e.message}`,"danger")})):e.reportValidity()}function t(e,t){const o=document.getElementById("notification");o.textContent=e,o.className=`alert alert-${t} position-fixed bottom-0 start-50 translate-middle-x mb-3`,o.classList.remove("d-none"),setTimeout((()=>{o.classList.add("d-none")}),3e3)}function o(e){try{document.querySelectorAll(".form-section").forEach((e=>e.style.display="none")),document.getElementById(e).style.display="block","editTaskForm"===e&&Excel.run((function(e){const t=e.workbook.worksheets.getItem("WBS").tables.getItem("TblWbs").getDataBodyRange().getColumn(0);return t.load("values"),e.sync().then((function(){const e=document.getElementById("editTaskID");e.innerHTML='<option value="">Chọn TaskID</option>',t.values.forEach((function(t){const o=document.createElement("option");o.value=t[0],o.textContent=t[0],e.appendChild(o)}))}))})).catch((function(e){console.log(e)}))}catch(e){console.error("Error showing form:",e);const t=document.getElementById("notification");t.textContent="Đã xảy ra lỗi khi hiển thị form.",t.classList.remove("d-none")}}function n(e,o){Excel.run((function(n){const r=n.workbook.worksheets.getItem("WBS").tables.getItem("TblWbs").getDataBodyRange();return r.load("values"),n.sync().then((function(){const n=r.values.find((t=>t[0]===e));n?("editForm"===o&&(document.querySelector("#editForm #taskName").value=n[1],document.querySelector("#editForm #type").value=n[2],document.querySelector("#editForm #pic").value=n[3],document.querySelector("#editForm #reviewer").value=n[4],document.querySelector("#editForm #pStartDate").value=u(n[5]),document.querySelector("#editForm #pEndDate").value=u(n[6]),document.querySelector("#editForm #pReleaseDate").value=u(n[7]),document.querySelector("#editForm #pEffort").value=n[8],document.querySelector("#editForm #aStartDate").value=u(n[9]),document.querySelector("#editForm #aEndDate").value=u(n[10]),document.querySelector("#editForm #aEffort").value=n[11],document.querySelector("#editForm #percentACompleted").value=n[12],document.querySelector("#editForm #aReleaseDate").value=u(n[13]),document.querySelector("#editForm #parentID").value=n[14],document.querySelector("#editForm #linkBackLog").value=n[15],document.querySelector("#editForm #linkJira").value=n[16],document.querySelector("#editForm #linkEvidence").value=n[17]),"progressForm"===o&&(document.querySelector("#progressForm #aStartDate").value=u(n[9]),document.querySelector("#progressForm #aEndDate").value=u(n[10]),document.querySelector("#progressForm #aEffort").value=n[11],document.querySelector("#progressForm #percentACompleted").value=n[12],document.querySelector("#progressForm #aReleaseDate").value=u(n[13]))):t("không tìm thấy thông tin: "+e,"danger")}))})).catch((function(e){console.log(e)}))}function r(e,o){Excel.run((function(n){const r=n.workbook.worksheets.getItem("WBS").tables.getItem("TblWbs").getDataBodyRange();return r.load("values"),n.sync().then((function(){const u=r.values,l=u.findIndex((t=>t[0]===e));if(t("index:"+l,"success"),-1!==l){const a=u.find((t=>t[0]===e));let d=[];return"editForm"===o&&(d=[e,document.querySelector("#editForm #taskName").value,document.querySelector("#editForm #type").value,document.querySelector("#editForm #pic").value,document.querySelector("#editForm #reviewer").value,c(document.querySelector("#editForm #pStartDate").value),c(document.querySelector("#editForm #pEndDate").value),c(document.querySelector("#editForm #pReleaseDate").value),document.querySelector("#editForm #pEffort").value,c(document.querySelector("#editForm #aStartDate").value),c(document.querySelector("#editForm #aEndDate").value),document.querySelector("#editForm #aEffort").value,document.querySelector("#editForm #percentACompleted").value,c(document.querySelector("#editForm #aReleaseDate").value),document.querySelector("#editForm #parentID").value,document.querySelector("#editForm #linkBackLog").value,document.querySelector("#editForm #linkJira").value,document.querySelector("#editForm #linkEvidence").value]),"progressForm"===o&&(d=[e,a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],c(document.querySelector("#progressForm #aStartDate").value),c(document.querySelector("#progressForm #aEndDate").value),document.querySelector("#progressForm #aEffort").value,document.querySelector("#progressForm #percentACompleted").value,c(document.querySelector("#progressForm #aReleaseDate").value),a[14],a[15],a[16],a[17]]),u[l]=d,r.values=u,n.sync().then((function(){t("Cập nhật thông tin thành công!","success")}))}t("Không tìm thấy thông tin: "+e,"danger")}))})).catch((function(e){console.log(e)}))}function u(e){return!e||isNaN(e)?"":new Date(86400*(e-25569)*1e3).toISOString().split("T")[0]}function c(e){const t=new Date(e);return 25569+(t.getTime()-60*t.getTimezoneOffset()*1e3)/864e5}Office.onReady((t=>{t.host===Office.HostType.Excel&&(Excel.run((function(e){return e.workbook.worksheets.getItem("WBS").activate(),e.sync()})).catch((function(e){console.log(e),e instanceof OfficeExtension.Error&&console.log("Debug info: "+JSON.stringify(e.debugInfo))})),document.getElementById("btnNewTaskForm").onclick=function(){o("newTaskForm")},document.getElementById("btnEditTaskForm").onclick=function(){o("editTaskForm")},document.getElementById("btnUpdateProgressForm").onclick=function(){o("updateProgressForm")},document.getElementById("editTaskInput").onblur=function(){n(this.value,"editForm")},document.getElementById("progressTaskID").onblur=function(){n(this.value,"progressForm")},document.getElementById("btnAddTask").onclick=e,document.getElementById("updateTask").onclick=function(){r(document.querySelector("#editForm #editTaskInput").value,"editForm")},document.getElementById("btnUpdateProgress").onclick=function(){r(document.querySelector("#progressForm #progressTaskID").value,"progressForm")})}))}();
//# sourceMappingURL=project_task.js.map